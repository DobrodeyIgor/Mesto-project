(()=>{"use strict";var e=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n),t.disabled=!1):(t.classList.add(n),t.disabled=!0)},t={baseUrl:"https://mesto.nomoreparties.co/v1/wbf-cohort-5",headers:{authorization:"a42e03f3-9db9-4d21-a03c-ed0890bb2c58","Content-Type":"application/json"}},n=function(){return fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))},o=function(e){return fetch("".concat(t.baseUrl,"/cards/").concat(e),{headers:t.headers,method:"DELETE"}).then((function(e){return e.ok})).catch((function(e){console.log(e)}))},r=function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{headers:t.headers,method:"PUT"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))},c=function(e){return fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{headers:t.headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))};function u(e){"Escape"===e.code&&l()}function a(e){e.stopPropagation()}function i(e){e.classList.remove("popup_opened"),e.querySelector(".popup__container").addEventListener("click",a),e.addEventListener("click",l),window.addEventListener("keyup",u)}function s(e){e.classList.add("popup_opened"),e.querySelector(".popup__container").addEventListener("click",a),e.addEventListener("click",l),window.addEventListener("keyup",u)}function l(){var e;(e=document.querySelectorAll(".popup_opened"),Array.from(e)).forEach((function(e){i(e)}))}var d=document.querySelector(".popup__figure"),f=d.querySelector(".popup__figure-image"),m=document.querySelector("#card");function p(e,t,u,a,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],p=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],y=m.content.cloneNode(!0).querySelector("div"),b=y.querySelector(".elements__item-title");b.title=e,b.textContent=e;var S=y.querySelector(".elements__image");S.alt=e,S.src=t,S.addEventListener("click",(function(){!function(e,t){d.querySelector(".popup__figure-caption").textContent=e,f.alt=e,f.src=t}(e,t),s(u)}));var q=y.querySelector(".elements__favorite-counter");q.textContent=l.length;var L=y.querySelector(".elements__favorite-button"),E="elements__favorite-button_active";v(l,i)?_(L,E):h(L,E),L.addEventListener("click",(function(){return function(e,t,o,u,a){n().then((function(n){v(n.find((function(e){return e._id===a})).likes,u)?c(a).then((function(n){!function(e){e.textContent=Number(e.textContent)-1}(t),h(e,o)})):r(a).then((function(n){!function(e){e.textContent=Number(e.textContent)+1}(t),_(e,o)}))}))}(L,q,E,i,a)}));var k=y.querySelector(".elements__remove-button");return p?k.addEventListener("click",(function(e){return function(e,t){e.stopPropagation(),o(t).then((function(t){t&&e.target.closest(".elements__item").remove()}))}(e,a)})):k.classList.add("elements__remove-button_inactive"),y}function v(e,t){return-1!==e.findIndex((function(e){return e._id===t}))}function _(e,t){e.classList.add(t)}function h(e,t){e.classList.remove(t)}var y=document.querySelector(".popup[data-type=create]"),b=document.querySelector(".popup[data-type=edit]"),S=document.querySelector(".popup[data-type=img]"),q=document.querySelector(".popup[data-type=avatar]"),L=document.querySelector(".profile__name"),E=document.querySelector("input[name=user-name"),k=document.querySelector(".profile__status"),g=document.querySelector("input[name=user-status"),C=document.querySelector(".profile__image"),x=document.querySelector("input[name=avatar-link]"),j=document.querySelector(".elements"),P="";fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)})).then((function(e){L.textContent=e.name,k.textContent=e.about,C.src=e.avatar,P=e._id,n().then((function(t){t.forEach((function(t){var n=e._id===t.owner._id,o=p(t.name,t.link,S,t._id,e._id,t.likes,n);j.append(o)}))}))}));var U=document.querySelector(".profile__button_move_edit"),A=document.querySelector(".popup__exit-button[data-type=edit]"),w=document.querySelector(".profile__button_move_add"),T=document.querySelector(".popup__exit-button[data-type=create]"),N=document.querySelector(".popup__exit-button[data-type=img]"),D=document.querySelector(".profile__image-wrapper"),B=document.querySelector(".popup__exit-button[data-type=avatar]");U.addEventListener("click",(function(){s(b),E.value=L.textContent,g.value=k.textContent})),A.addEventListener("click",(function(){return i(b)})),w.addEventListener("click",(function(){return s(y)})),T.addEventListener("click",(function(){return i(y)})),N.addEventListener("click",(function(){return i(S)})),D.addEventListener("click",(function(){return s(q)})),B.addEventListener("click",(function(){return i(q)}));var O=document.querySelector("form[data-type=edit]");O.addEventListener("submit",(function(e){e.preventDefault(),Z(J),function(e){return fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers,method:"PATCH",body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))}({name:E.value,about:g.value}).then((function(e){L.textContent=e.name,k.textContent=e.about})).finally((function(){$(J),i(b)}))}));var J=O.querySelector(".form__submit-button"),H=document.querySelector("input[name=place-name]"),z=document.querySelector("input[name=place-image]"),I=document.querySelector("form[data-type=create]");I.addEventListener("submit",(function(e){e.preventDefault(),Z(M),function(e){return fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers,method:"POST",body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))}({name:H.value,link:z.value}).then((function(e){var t=p(e.name,e.link,S,e._id,P);j.prepend(t),H.value="",z.value=""})).finally((function(){$(M),i(y)}))}));var M=I.querySelector(".form__submit-button"),F=document.querySelector("form[data-type=avatar]");F.addEventListener("submit",(function(e){e.preventDefault(),Z(Y),function(e){return fetch("".concat(t.baseUrl,"/users/me/avatar"),{headers:t.headers,method:"PATCH",body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).catch((function(e){console.log(e)}))}({avatar:x.value}).then((function(e){C.src=x.value})).finally((function(){$(Y),i(q)}))}));var G,K,Q,R,V,W,X,Y=F.querySelector(".form__submit-button");function Z(e){e.disabled=!0,e.textContent="Сохранение...",e.classList.add("form__submit-button_inactive")}function $(e){e.disabled=!1,e.textContent="Сохранить",e.classList.remove("form__submit-button_inactive")}K=(G={formSelector:".form",inputSelector:".form__text-field",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_inactive",inputErrorClass:"form__text-field_type_error",errorClass:"form__text-field-error_active"}).formSelector,Q=G.inputSelector,R=G.submitButtonSelector,V=G.inactiveButtonClass,W=G.inputErrorClass,X=G.errorClass,Array.from(document.querySelectorAll(K)).forEach((function(t){!function(t,n,o,r,c,u){var a=Array.from(t.querySelectorAll(n)),i=t.querySelector(o);e(a,i,r),a.forEach((function(n){n.addEventListener("input",(function(){!function(e,t,n,o){t.validity.valid?function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),r.classList.remove(o),r.textContent=""}(e,t,n,o):function(e,t,n,o,r){var c=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o),c.textContent=n,c.classList.add(r)}(e,t,t.validationMessage,n,o)}(t,n,c,u),e(a,i,r)}))}))}(t,Q,R,V,W,X)}))})();